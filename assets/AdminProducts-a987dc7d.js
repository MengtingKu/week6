import{_ as m,o,c as i,e as t,k as _,f as g,F as P,h as f,t as h,a as l,r as v,b as $}from"./index-be1a73cb.js";const b={props:["pages","getProducts"]},x={"aria-label":"Page navigation example",class:"mb-5"},L={class:"pagination"},y=t("span",{"aria-hidden":"true"},"«",-1),A=[y],w=["onClick"],N=t("span",{"aria-hidden":"true"},"»",-1),T=[N];function E(e,s,a,k,u,d){return o(),i("nav",x,[t("ul",L,[t("li",{class:_(["page-item",{disabled:!a.pages.has_pre}])},[t("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:s[0]||(s[0]=g(n=>a.getProducts(a.pages.current_page-1),["prevent"]))},A)],2),(o(!0),i(P,null,f(a.pages.total_pages,n=>(o(),i("li",{class:_(["page-item",{active:n===a.pages.current_page}]),key:n+"page"},[t("a",{class:"page-link",href:"#",onClick:g(c=>a.getProducts(n),["prevent"])},h(n),9,w)],2))),128)),t("li",{class:_(["page-item",{disabled:!a.pages.has_next}])},[t("a",{class:"page-link",href:"#","aria-label":"Next",onClick:s[1]||(s[1]=g(n=>a.getProducts(a.pages.current_page+1),["prevent"]))},T)],2)])])}const C=m(b,[["render",E]]),{VITE_APP_URL:r,VITE_APP_PATH:p}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_APP_PATH:"qwe1234",BASE_URL:"/week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},U={data(){return{products:[],isNew:!0,isLoading:!0,page:{}}},components:{pagination:C},methods:{checkLogin(){l.post(`${r}/api/user/check`).then(e=>{console.log(e.data),this.getProductList(),this.isLoading=!1}).catch(e=>{console.log(e),alert(e.response.data.message)})},getProductList(e=1){l.get(`${r}/api/${p}/admin/products/?page=${e}`).then(s=>{this.page=s.data.pagination,this.products=s.data.products}).catch(s=>{console.log(s),alert(s.response.data.message)})},openModal(e,s){e==="create"?(this.isNew=!0,this.tempProduct={imagesUrl:[]}):e==="edit"?(this.isNew=!1,this.tempProduct={...s},Array.isArray(this.tempProduct.imagesUrl)||(this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push(""))):e==="del"&&(this.tempProduct={...s})},updateProduct(){let e=`${r}/api/${p}/admin/product`,s="post";this.isNew||(s="put",e=`${r}/api/${p}/admin/product/${this.tempProduct.id}`),l[s](e,{data:this.tempProduct}).then(a=>{alert(a.data.message),this.getProductList()}).catch(a=>{console.log(a.response),alert(a.response.data.message)})},deleteProduct(){l.delete(`${r}/api/${p}/admin/product/${this.tempProduct.id}`).then(e=>{this.getProductList(),alert(e.data.message)}).catch(e=>{console.log(e),alert(e.response.data.message)})},toThousands(e){let s=e.toString().split(".");return s[0]=s[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),s.join(".")}},mounted(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)tokenId\s*=\s*([^;]*).*$)|^.*$/,"$1");l.defaults.headers.common.Authorization=e,this.checkLogin()}},V={key:0,class:"loading"},B=t("div",{class:"bounceBall me-2"},null,-1),I=t("div",{class:"text h5"},"NOW LOADING...ʕ̯•͡ˑ͓•̯᷅ʔ",-1),D=[B,I],R={key:1,class:"container"},S={class:"text-end mt-4"},M={class:"table table-striped table-hover mt-4"},O=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{class:"text-center",width:"120"},"原價"),t("th",{class:"text-center",width:"120"},"售價"),t("th",{class:"text-center",width:"100"},"是否啟用")])],-1),z={class:"text-center"},F={class:"text-center"},H={class:"text-center"},j={key:0,class:"text-success"},q={key:1};function G(e,s,a,k,u,d){const n=v("pagination");return u.isLoading?(o(),i("div",V,D)):(o(),i("div",R,[t("div",S,[t("button",{type:"button",class:"btn btn-primary",onClick:s[0]||(s[0]=c=>d.openModal("create"))}," 建立新的產品 ")]),t("table",M,[O,t("tbody",null,[(o(!0),i(P,null,f(u.products,c=>(o(),i("tr",{key:c.id},[t("td",null,h(c.category),1),t("td",null,h(c.title),1),t("td",z,h(d.toThousands(c.origin_price)),1),t("td",F,h(d.toThousands(c.price)),1),t("td",H,[c.is_enabled?(o(),i("span",j,"啟用")):(o(),i("span",q,"未啟用"))])]))),128))])]),$(n,{pages:u.page,"get-products":d.getProductList},null,8,["pages","get-products"])]))}const J=m(U,[["render",G]]);export{J as default};
